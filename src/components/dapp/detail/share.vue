<script setup lang="ts">
import { ref, onMounted, defineProps } from 'vue'
import I18n from '~/utils/i18n/index';

defineProps({
  data: {
    type: Object,
    required: true
  }
})

const link = ref<string>('http://kingdata.com')

const discord = ref<string>('https://discord.gg/c9wTAgeAwz')

onMounted(function() {
  link.value = window.location.href
})

</script>

<template>
  <div>
    <div class="flex items-center">
      <IconFont class="mr-1.5" type="key" size="24" bright/>
      <h3 class="text-global-highTitle text-opacity-85 text-18 font-m">{{ I18n.dapp.share.title }}</h3>
    </div>
    <div class="flex wrap-share mt-3 text-global-highTitle text-opacity-65">
      <!-- 大屏模式 -->
      <div class="share-step hidden md:block">
        <ul class="flex text-center">
          <li class="flex-1">
            <div class="line">
              <span>
                <b class="text-16 text-number">1</b>
              </span>
            </div>
            <div class="px-1 md:pl-0 md:pr-3 text-14-18">
              <span class="block">{{ I18n.dapp.share.step.count }}</span>
              <span class="block">{{ I18n.dapp.share.step.platform }}</span>
            </div>
          </li>
          <li class="flex-1">
            <div class="line">
              <span>
                <b class="text-16 text-number">2</b>
              </span>
            </div>
            <div class="px-1 md:px-3 text-14-18">
              <span class="block">{{ I18n.dapp.share.step.send }}</span>
              <UiFooterHover :href="discord">
                <span class="flex items-center justify-center">
                  <IconFont type="discord" bright/>
                  <span class="ml-1 text-global-darkblue">Discord</span>
                </span>
              </UiFooterHover>
            </div>
          </li>
          <li class="flex-1">
            <div class="line">
              <span>
                <b class="text-16 text-number">3</b>
              </span>
            </div>
            <div class="px-1 md:px-3 text-14-18">
              <span class="block">{{ I18n.dapp.share.step.join }}</span>
              <span class="block">{{ I18n.dapp.share.step.wechat }}</span>
            </div>
          </li>
        </ul>
      </div>
      <!-- 小屏模式 -->
      <div class="share-step md:hidden">
        <div class="flex">
          <div class="dot text-16 text-number">1</div>
          <div class="ml-1.5 flex-1">
            <span>{{ I18n.dapp.share.step.count }}</span>
            <span>{{ I18n.dapp.share.step.platform }}</span>
          </div>
        </div>
        <div class="flex items-start mt-6">
          <div class="dot text-16 text-number">2</div>
          <div class="ml-1.5 flex-1">
            <span class="align-middle">{{ I18n.dapp.share.step.send }}</span>
            <a class="ml-1 inline-block items-center justify-center" v-router.blank="discord">
              <IconFont class="align-middle" type="discord" bright/>
              <span class="align-middle ml-1 text-global-darkblue">Discord</span>
            </a>
          </div>
        </div>
        <div class="flex items-start mt-6">
          <div class="dot text-16 text-number">3</div>
          <div class="ml-1.5 flex-1">
            <span class="align-middle">{{ I18n.dapp.share.step.join }}</span>
            <span class="align-middle">{{ I18n.dapp.share.step.wechat }}</span>
          </div>
        </div>
      </div>
      <div class="w-full md:w-80 md:pl-6 flex mt-6 md:mt-0">
        <div class="wrap-copy">
          <div class="pr-3">
            <h5 class="text-14-18">
              <span class="copy-label">{{ I18n.dapp.share.label }}</span>
            </h5>
          </div>
          <div class="wrap-copy-button" v-login>
            <el-input class="w-full" :model-value="link" size="small"/>
            <span class="ml-2 flex cursor-pointer" v-copy.message="link" :message="I18n.dapp.share.message">
              <IconFont type="copy"/>
            </span>
          </div>
        </div>
        <div class="ml-3 hidden md:flex">
          <UiQrcode :value="link" width="68" height="68" border/>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped lang="scss">
.wrap-share {
  @apply flex-wrap flex-col;
  .share-step {
    @apply w-full;
  }

  @screen md {
    @apply flex-nowrap flex-row;

    .share-step {
      @apply pr-6;
      @apply w-1 flex-1;
      @apply border-0 border-r border-solid border-global-highTitle border-opacity-6;
    }
  }
}

.wrap-copy {
  @apply flex w-full;

  .copy-label {
    @apply leading-8;
  }

  .wrap-copy-button {
    @apply flex items-center flex-1;
  }

  @screen md {
    @apply h-17 content-between flex-wrap;
    .copy-label {
      line-height: inherit;
    }
    .wrap-copy-button {
      @apply flex-auto;
    }
  }
}

.dot {
  background-color: #09D98E;
  border-radius: 40px;
  height: 22px;
  line-height: 22px;
  @apply min-w-8 text-center text-white;
}

ul {
  li {
    @apply whitespace-nowrap;
    .line {
      @apply mb-2 block;
      @apply relative;
      @apply text-white;
      &:before, &:after {
        content: "";
        height: 1px;
        background-color: rgba(9, 217, 142, 0.24);
        @apply absolute top-1/2 w-1/2 transform -translate-y-1/2;
      }
      &:before {
        @apply left-0;
      }
      &:after {
        @apply right-0;
      }
      span {
        @apply inline-block px-1;
        @apply relative z-1;
        &:before{
          content: "";
          @apply bg-white;
          @apply absolute top-0 bottom-0 -left-3 -right-3;
        }
      }
      b {
        @apply inline-block;
        @apply relative z-2;
        font-weight: normal;
        background: #09D98E;
        border-radius: 40px;
        min-width: 32px;
        height: 22px;
        line-height: 22px;
      }
    }
    &:first-child {
      .line {
        &:before {
          content: none;
        }
      }
    }
    &:last-child {
      .line {
        &:after {
          content: none;
        }
      }
    }
  }
}
</style>
